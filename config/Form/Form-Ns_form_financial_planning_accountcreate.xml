<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE Form PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<Form name="NS_Form_Financial_Planning_AccountCreate" type="Application">
  <Attributes>
    <Map>
      <entry key="pageTitle" value="NS_Form_Financial_Planning_AccountCreate"/>
    </Map>
  </Attributes>
  <Section label="Financial Account Details" name="financialPlanningAccountSection">
    <Field displayName="Employee" name="employee" type="string">
      <Script>
        <Source>return identity.getAttribute("firstname") + " " + identity.getAttribute("lastname");</Source>
      </Script>
    </Field>
    <Field displayName="First Name" name="firstName" type="string">
      <Script>
        <Source>return identity.getAttribute("firstname");</Source>
      </Script>
    </Field>
    <Field displayName="Last Name" name="lastName" type="string">
      <Script>
        <Source>return identity.getAttribute("lastname");</Source>
      </Script>
    </Field>
    <Field displayName="Employment Status" name="empStatus" type="string">
      <Script>
        <Source>return "Active";</Source>
      </Script>
    </Field>
    <Field displayName="Department" name="department" type="string">
      <Script>
        <Source>return identity.getAttribute("department");</Source>
      </Script>
    </Field>
    <Field displayName="User Level" name="userLevel" type="string">
      <RuleRef>
        <Reference class="sailpoint.object.Rule" name="NS_Rule_Financial_Planning_FieldValue_UserLevel"/>
      </RuleRef>
    </Field>
    <Field displayName="Hire Date" name="hireDate" type="string">
      <Script>
        <Source>return identity.getAttribute("hireDate");</Source>
      </Script>
    </Field>
    <Field displayName="Salary Class" name="salaryClass" type="string">
      <RuleRef>
        <Reference class="sailpoint.object.Rule" name="NS_Rule_Financial_Planning_FieldValue_salaryClass"/>
      </RuleRef>
    </Field>
    <Field displayName="Termination Date" name="terminationDate" type="string">
      <Script>
        <Source>return identity.getAttribute("terminationDate");</Source>
      </Script>
    </Field>
    <Field displayName="Work State" name="workState" type="string">
      <Script>
        <Source>
		    import org.SailPoint_IIQ.Utils.Utils;
			import sailpoint.object.Link;

			Link link = Utils.getHrLink(context,identity.getName());
			if(link != null &amp;&amp; link.getAttribute("REGION")!= null) {
				return link.getAttribute("REGION");
			}else{
				return "";
			}
		</Source>
      </Script>
    </Field>
    <Field displayName="Email" name="email" type="string">
      <Script>
        <Source>return identity.getAttribute("email");</Source>
      </Script>
    </Field>
    <Field displayName="Country Code" name="countryCode" type="string">
      <Script>
        <Source>
	        import org.SailPoint_IIQ.Utils.Utils;
			import sailpoint.object.Link;

			Link link = Utils.getHrLink(context,identity.getName());
			if(link != null &amp;&amp; link.getAttribute("POSTAL_CODE")!= null) {
				return link.getAttribute("POSTAL_CODE");
			}else{
				return "";
			}
      </Source>
      </Script>
    </Field>
    <Field displayName="Work Country" name="workCountry" type="string">
      <Script>
        <Source>return identity.getAttribute("country");</Source>
      </Script>
    </Field>
    <Field displayName="Manager" name="manager" type="string">
      <Script>
        <Source>
		import sailpoint.object.Identity;
		Identity managerIdentity= identity.getManager();
        if(managerIdentity!=null)
    	return managerIdentity.getDisplayableName();
		 </Source>
      </Script>
    </Field>
    <Field displayName="Supervisor ID" name="superviserId" type="string">
      <Script>
        <Source>
		import sailpoint.object.Identity;
		Identity managerIdentity= identity.getManager();
        if(managerIdentity!=null)
    	return managerIdentity.getAttribute("employeeId");
		</Source>
      </Script>
    </Field>
    <Field displayName="Employee ID" name="employeeId" type="string">
      <Script>
        <Source>return identity.getAttribute("employeeId");</Source>
      </Script>
    </Field>
    <Field displayName="Business Unit" name="bussinessUnit" type="string">
      <Script>
        <Source>
			import org.SailPoint_IIQ.Utils.Utils;
			import sailpoint.object.Link;

			Link link = Utils.getHrLink(context,identity.getName());
			if(link != null &amp;&amp; link.getAttribute("BUSINESS_UNIT_ID")!= null) {
				return link.getAttribute("BUSINESS_UNIT_ID");
			}else{
				return "";
			}
		</Source>
      </Script>
    </Field>
    <Field displayName="Annual Hours" name="annualHours" type="string">
      <Script>
        <Source>
		String employmentType=identity.getAttribute("employmentType");
		if(employmentType!=null &amp;&amp; employmentType.equalsIgnoreCase("Full_time"))
		return "1920";
		else
		return "1040";
		</Source>
      </Script>
    </Field>
    <Field displayName="Job Title" name="jobTitle" type="string">
      <Script>
        <Source>return identity.getAttribute("title");</Source>
      </Script>
    </Field>
    <Field displayName="Is Manager" name="isManager" type="string">
      <Script>
        <Source>
		boolean managerStatus=identity.getManagerStatus();
		if(managerStatus)
		return "Yes";
		else
		return "No";
		</Source>
      </Script>
    </Field>
  </Section>
</Form>